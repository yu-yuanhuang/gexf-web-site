<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>社會網絡圖互動展示</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Libraries (deferred to avoid blocking first paint) -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/sigma.js/2.4.0/sigma.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/graphology/0.25.4/graphology.umd.min.js"></script>

  <!-- App -->
  <script defer src="app.js"></script>
</head>
<body>
  <div id="app">
    <aside id="sidebar">
      <div class="sidebar-header">
        <div class="title">社會網絡圖（互動展示）</div>
        <div class="subtitle" id="stats">尚未載入</div>
      </div>

      <section class="panel">
        <h2>顯示控制</h2>

        <div class="field">
          <label>
            <input type="checkbox" id="toggle-isolates" checked />
            顯示孤立節點
          </label>
        </div>

        <div class="field">
          <label>
            <input type="checkbox" id="toggle-edges" checked />
            <span id="toggle-edges-text">顯示：邊</span>
          </label>
        </div>

        <div class="field">
          <label for="edge-width">邊寬度（edge width）</label>
          <div class="range-row">
            <input type="range" id="edge-width" min="0.5" max="8" step="0.1" value="3" />
            <div class="range-value" id="edge-width-val">3</div>
          </div>
          <div class="hint">調整線條粗細（僅影響視覺呈現，不改變資料）。</div>
        </div>

        <div class="field">
          <label for="edge-weight">邊權重門檻（weight）</label>
          <div class="range-row">
            <input type="range" id="edge-weight" min="0" max="1" step="0.01" value="0" />
            <div class="range-value" id="edge-weight-val">0</div>
          </div>
          <div class="hint" id="edge-weight-hint"></div>
        </div>

        <div class="field">
          <label for="degree">邊數門檻（degree）</label>
          <div class="range-row">
            <input type="range" id="degree" min="0" max="1" step="1" value="0" />
            <div class="range-value" id="degree-val">0</div>
          </div>
          <div class="hint" id="degree-hint"></div>
        </div>

        <div class="field">
          <label for="wdegree">加權邊數門檻（weighted degree）</label>
          <div class="range-row">
            <input type="range" id="wdegree" min="0" max="1" step="0.01" value="0" />
            <div class="range-value" id="wdegree-val">0</div>
          </div>
          <div class="hint" id="wdegree-hint"></div>
        </div>

        <div class="field">
          <label for="betweenness">中介中心性門檻（betweenness）</label>
          <div class="range-row">
            <input type="range" id="betweenness" min="0" max="1" step="0.01" value="0" />
            <div class="range-value" id="betweenness-val">0</div>
          </div>
          <div class="hint" id="betweenness-hint"></div>
        </div>
      </section>

      <section class="panel">
        <h2>節點清單（顯示／不顯示）</h2>
        <div class="field">
          <input type="text" id="node-search" placeholder="搜尋節點…" />
        </div>
        <div class="buttons-row">
          <button id="btn-all" type="button">全選</button>
          <button id="btn-none" type="button">全不選</button>
          <button id="btn-invert" type="button">反選</button>
        </div>
        <div id="node-list" class="node-list"></div>
      </section>

      <section class="panel">
        <h2>圖譜外觀</h2>

        <div class="field">
          <label for="theme-mode">背景／配色</label>
          <select id="theme-mode">
            <option value="white" selected>白底（預設）</option>
            <option value="black">黑底（節點外圈白／線條白）</option>
            <option value="custom">自訂配色（背景／節點／線條）</option>
          </select>
          <div class="hint">切換後僅影響右側圖譜區域，不影響左側控制面板外觀。</div>
        </div>

        <div id="custom-colors" class="custom-colors" style="display:none;">
          <div class="color-row">
            <div class="color-field">
              <label for="color-bg">背景色</label>
              <input id="color-bg" type="color" value="#ffffff" />
            </div>
            <div class="color-field">
              <label for="color-node">節點顏色</label>
              <input id="color-node" type="color" value="#4da3ff" />
            </div>
            <div class="color-field">
              <label for="color-edge">線條顏色</label>
              <input id="color-edge" type="color" value="#111827" />
            </div>
          </div>
          <div class="hint">自訂配色會套用到所有節點與邊；滑鼠hover之強弱對比仍會保留。</div>
        </div>
      </section>

      <section class="panel">
        <h2>輸出下載</h2>
        <div class="buttons-row">
          <button id="btn-export-png" type="button">下載PNG</button>
          <button id="btn-export-svg" type="button">下載SVG</button>
        </div>
        <div class="hint">PNG為畫面截圖（含目前縮放與平移）；SVG優先輸出向量（若瀏覽器不支援則回退為嵌入PNG之SVG）。</div>
      </section>

      <section class="panel small">
        <h2>操作提示</h2>
        <ul class="tips">
          <li>滑鼠滾輪：放大／縮小</li>
          <li>拖曳空白處：平移</li>
          <li>游標停在節點上：顯示節點資訊</li>
        </ul>
      </section>

      <section class="panel small note">
        <h2>說明</h2>
        <div class="hint">
          本站以「展示」為目的，已在資料端完成主要計算（布局與指標），前端僅負責渲染與過濾。
        </div>
      </section>
    </aside>

    <main id="main">
      <div id="graph-container"></div>

      <div id="graph-toolbar">
        <button id="zoom-in" title="放大" type="button">＋</button>
        <button id="zoom-out" title="縮小" type="button">－</button>
        <button id="reset" title="重置視角" type="button">重置</button>
      </div>

      <div id="tooltip" class="tooltip" style="display:none;"></div>

      <!-- Loading overlay with progress bar -->
      <div id="load-overlay" class="load-overlay" aria-live="polite">
        <div class="load-card">
          <div class="load-title">載入圖譜中…</div>
          <div class="load-bar"><div id="load-bar-inner" class="load-bar-inner"></div></div>
          <div id="load-text" class="load-text">準備中</div>
        </div>
      </div>
    </main>
  </div>
</body>
</html>
